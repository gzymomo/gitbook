[TOC]

# 1、Shell变量
## 1.1 系统变量

```bash
$SHELL  默认 Shell
$HOME  当前用户家目录
$IFS  内部字段分隔符
$LANG  默认语言
$PATH  默认可执行程序路径
$PWD  当前目录
$UID  当前用户 ID
$USER  当前用户
$HISTSIZE  历史命令大小，可通过 HISTTIMEFORMAT 变量设置命令执行时间
$RANDOM  随机生成一个 0 至 32767 的整数
$HOSTNAME  主机名
```

## 1.2 位置变量
位置变量指的是函数或脚本后跟的第 n 个参数。
1−1−n，需要注意的是从第 10 个开始要用花括号调用，例如${10}
shift 可对位置变量控制，例如：

```bash
#!/bin/bash
echo "1: $1"
shift
echo "2: $2"
shift
echo "3: $3"

sh test.sh 1 2 3
1: 1
2: 3
3: 
# 每执行一次 shift 命令，位置变量个数就会减一，而变量值则提前一位。shift n，可设置向前移动n位。
```

## 1.3 特殊变量
```bash
$0  # 脚本自身名字
$?  # 返回上一条命令是否执行成功，0 为执行成功，非 0 则为执行失败
$#  # 位置参数总数
$*  # 所有的位置参数被看做一个字符串
$@  # 每个位置参数被看做独立的字符串
$$  # 当前进程 PID
$!  # 上一条运行后台进程的 PID
```

## 1.4 Shell变量的输入
Shell变量除了可以直接赋值或脚本传参外，还可以使用read命令从标准输入获得。

### 1.4.1 语法格式
```bash
# read [参数] [变量名]
```

### 1.4.2 常用参数
```bash
# -p prompt: 设置提示信息
# -t timeout: 设置输入等待的事件,单位默认为秒
```
read的基本读入

如果不加-t read就会一直等待
```bash
# read后面的参数是一个变量
[root@youmen ~]# read -p 'please input you num:' num
please input you num:234
[root@youmen ~]# echo $num
234


# 设置超时事件为3秒
read -t 3 -p "please input you num:" num
please input you num:
# 过3秒钟会脚本会自己执行结束
```

### 1.4.3 read在脚本中常用例子
```bash
[root@youmen ~]# sh test.sh 
please input you num: 1 2
1-2 =-1
1+2 =3
1*2 =2
1/2 =0
1**2 =1
1%2 =1
[root@youmen ~]# cat abc.sh 
#!/bin/bash
read -t 18 -p "please input you num:" a b
echo "$a-$b =$(( $a - $b ))"
echo "$a+$b =$(( $a + $b ))"
echo "$a*$b =$(( $a * $b ))"
echo "$a/$b =$(( $a / $b ))"
echo "$a**$b =$(( $a ** $b ))"
echo "$a%$b =$(( $a % $b ))"

# 利用echo 命令替代和read -p的功能
[root@youmen ~]# cat test.sh 
#!/bin/bash
echo -n "请输入两个数字:"
read a b 
echo "$a+$b =$(( $a + $b ))"
echo "$a*$b =$(( $a * $b ))"
echo "$a/$b =$(( $a / $b ))"
echo "$a**$b =$(( $a ** $b ))"
echo "$a%$b =$(( $a % $b ))"

[root@youmen ~]# bash test.sh 
请输入两个数字:2 3
2+3 =5
2*3 =6
2/3 =0
2**3 =8
2%3 =2
```

# 2、条件测试与比较
条件测试通常由如下3种语法形式
```bash
# 语法1：test<测试表达式>
# 语法2：[<测试表达式>]
# 语法3：[[<测试表达式>]]

# 说明
# 1.上述语法格式1和语法格式2的写法是相等的。语法格式3为扩展的test命令。推荐使用语法格式2.

# 2.在[[]]中可以使用通配符进行模式匹配。&&、||、>、<等操作可以应用于[[]]中，但不能应用于[]中.

# 3.对于整数的关系运算，也可以使用Shell的算术运算符(())
```

## 2.1 文件表达式
```bash
操作符 说明 举例

# -b file 检测文件是否是块设备文件，如果是，则返回 true。 [ -b $file ] 返回 false。

# -c file 检测文件是否是字符设备文件，如果是，则返回 true。 [ -c $file ] 返回 false。

# -d file 检测文件是否是目录，如果是，则返回 true。 [ -d $file ] 返回 false。

# -f file 检测文件是否是普通文件（既不是目录，也不是设备文件），如果是，则返回 true。 [ -f $file ] 返回 true。 

# -g file 检测文件是否设置了 SGID 位，如果是，则返回 true。 [ -g $file ] 返回 false。 

# -k file 检测文件是否设置了粘着位(Sticky Bit)，如果是，则返回 true。 [ -k $file ] 返回 false。 

# -p file 检测文件是否是具名管道，如果是，则返回 true。 [ -p $file ] 返回 false。

# -u file 检测文件是否设置了 SUID 位，如果是，则返回 true。 [ -u $file ] 返回 false。

# -r file 检测文件是否可读，如果是，则返回 true。 [ -r $file ] 返回 true。

# -w file 检测文件是否可写，如果是，则返回 true。 [ -w $file ] 返回 true。

# -x file 检测文件是否可执行，如果是，则返回 true。 [ -x $file ] 返回 true。

# -s file 检测文件是否为空（文件大小是否大于0），不为空返回 true。 [ -s $file ] 返回 true。

# -e file 检测文件（包括目录）是否存在，如果是，则返回 true。 [ -e $file ] 返回 true。

# 特别说明：这些操作符号对于[[]]、[]、test几乎都是通用的，
```

# 3、字符串表达式
字符串测试操作符的作用有：比较两个字符串是否相同、字符串的长度是否为零，字符串是否为NULL（注：bash区分零长度字符串和空字符串）等

常用字符串测试操作符 说明 -z “字符串” 若串长度为0则真，-z可以理解为zero -n ”字符串“ 若昂度不为0则真，-n 可以理解为no zero ”串1“ = ”串2“

若串1等于串2则真，可以使用”==“代替”=“

“串2” ！= “串2”

若串1不等于串2则真，不能用“！==“ 代替”！=“ 特别注意：

## 3.1 字符串测试操作符提示
```bash
# 1）-n 比较字符串长度是否不为零，如果不为零则为真，如：[ -n “$myvar” ]

# 2）-z 比较字符串长度是否等于零，如果等于零则为真，如：[ -z “$myvar” ]

# 特别注意
# 对于以上表格中的字符串测试操作符号，如[ -n “$myvar” ]，要把字符串用“”引起来。

# 1、字符串或字符串变量比较都要加双引号之后再比较。

# 2、字符串或字符串变量比较，比较符号两端最好都有空格，可以参考系统脚本

# “=”比较两个字符串是否相同，与“==”等价，如[ “$a” = “$b” ]其中$a这样的变量最好用“”括起来，因为如果中间由空格，*等符号就可能出错，更好的办法就是[ “${a}” = “${b}” ]

# “！=” 比较两个字符串是否相同，不同则为“是”
```

# 4、逻辑操作符
在[]和test中使用 在[[]]中使用 说明 -a && and与，两端都为真，则真 -o || or或，两端有一个为真则真 ！ ！ not非，相反则为真

```bash
# ！中文意思是反：与一个逻辑值相关的逻辑值

# -a 中文意思是（and|&&）：两个逻辑值都为“真”，返回值才为“真”，反之为“假”

# -o 中文意思是或（or| ||）：两个逻辑值只要有一个为“真”，返回值就为“真”

# 逻辑操作运算规则
# -a和&& 的运算规则：只有两端都是1才为真
# 要想使用&&注意双括号
```
